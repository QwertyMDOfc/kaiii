<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KAII STORE - Premium Digital Store</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* ===== CSS VARIABLES ===== */
        :root {
            --primary: #6366f1;
            --primary-dark: #4f46e5;
            --secondary: #8b5cf6;
            --accent: #ec4899;
            --success: #10b981;
            --danger: #ef4444;
            --warning: #f59e0b;
            --dark: #1f2937;
            --darker: #111827;
            --light: #f3f4f6;
            --card-bg: #374151;
            --text-primary: #ffffff;
            --text-secondary: #9ca3af;
            --border: #4b5563;
            --shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        /* ===== RESET & BASE STYLES ===== */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            background: linear-gradient(135deg, var(--darker) 0%, var(--dark) 100%);
            color: var(--text-primary);
            min-height: 100vh;
            line-height: 1.6;
            overflow-x: hidden;
        }

        /* ===== ANIMATIONS ===== */
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes slideInLeft {
            from {
                opacity: 0;
                transform: translateX(-30px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        @keyframes slideInRight {
            from {
                opacity: 0;
                transform: translateX(30px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        @keyframes slideInDown {
            from {
                opacity: 0;
                transform: translateY(-30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        @keyframes bounce {
            0%, 20%, 53%, 80%, 100% {
                transform: translateY(0);
            }
            40%, 43% {
                transform: translateY(-10px);
            }
            70% {
                transform: translateY(-5px);
            }
            90% {
                transform: translateY(-2px);
            }
        }

        @keyframes float {
            0% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
            100% { transform: translateY(0px); }
        }

        @keyframes glow {
            0% { box-shadow: 0 0 5px rgba(99, 102, 241, 0.5); }
            50% { box-shadow: 0 0 20px rgba(99, 102, 241, 0.8), 0 0 30px rgba(99, 102, 241, 0.6); }
            100% { box-shadow: 0 0 5px rgba(99, 102, 241, 0.5); }
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); }
            20%, 40%, 60%, 80% { transform: translateX(5px); }
        }

        @keyframes rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        /* ===== LAYOUT ===== */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 1rem;
        }

        .mobile-container {
            padding: 0 0.75rem;
        }

        .grid {
            display: grid;
            gap: 1rem;
        }

        .flex {
            display: flex;
        }

        .flex-center {
            align-items: center;
            justify-content: center;
        }

        .flex-between {
            align-items: center;
            justify-content: space-between;
        }

        .flex-col {
            flex-direction: column;
        }

        .gap-2 { gap: 0.5rem; }
        .gap-3 { gap: 0.75rem; }
        .gap-4 { gap: 1rem; }
        .gap-6 { gap: 1.5rem; }

        /* ===== HEADER ===== */
        header {
            background: rgba(31, 41, 55, 0.95);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid var(--border);
            position: sticky;
            top: 0;
            z-index: 1000;
            box-shadow: var(--shadow);
            animation: slideInDown 0.5s ease-out;
        }

        .header-content {
            padding: 1rem 0;
        }

        .logo {
            font-size: 1.75rem;
            font-weight: 700;
            background: linear-gradient(135deg, var(--primary), var(--accent));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            animation: glow 3s infinite;
            transition: var(--transition);
        }

        .logo:hover {
            animation: bounce 1s;
            transform: scale(1.05);
        }

        .nav-menu {
            display: flex;
            gap: 0.75rem;
            align-items: center;
        }

        /* ===== RESPONSIVE NAV ===== */
        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                gap: 1rem;
            }

            .nav-menu {
                width: 100%;
                justify-content: center;
            }
        }

        @media (max-width: 480px) {
            .nav-menu {
                flex-direction: column;
                width: 100%;
                gap: 0.5rem;
            }
        }
    </style>
</head>
<body>
    <!-- ===== HEADER ===== -->
    <header>
        <div class="container">
            <div class="header-content flex-between">
                <div class="logo">
                    <i class="fas fa-store"></i>
                    KAII STORE
                </div>
                <nav class="nav-menu" id="navMenu">
                    <button class="btn btn-secondary" onclick="showLogin()">
                        <i class="fas fa-sign-in-alt"></i>
                        <span>Login</span>
                    </button>
                    <button class="btn btn-primary" onclick="showRegister()">
                        <i class="fas fa-user-plus"></i>
                        <span>Register</span>
                    </button>
                </nav>
            </div>
        </div>
    </header>

    <!-- ===== MAIN CONTENT ===== -->
    <main class="container" style="padding-top: 2rem; padding-bottom: 2rem;">
        <!-- ===== AUTH SECTION ===== -->
        <section id="authSection" class="auth-container">
            <div class="auth-card">
                <div class="auth-header">
                    <div class="auth-icon">
                        <i class="fas fa-user-circle"></i>
                    </div>
                    <h2 class="auth-title" id="authTitle">Login</h2>
                </div>
                <form id="authForm" onsubmit="handleAuth(event)">
                    <div class="form-group">
                        <label class="form-label">
                            <i class="fas fa-user"></i>
                            Username
                        </label>
                        <input type="text" class="form-control" id="username" required placeholder="Masukkan username">
                    </div>
                    <div class="form-group">
                        <label class="form-label">
                            <i class="fas fa-lock"></i>
                            Password
                        </label>
                        <input type="password" class="form-control" id="password" required placeholder="Masukkan password">
                    </div>
                    <div class="form-group hidden" id="emailGroup">
                        <label class="form-label">
                            <i class="fas fa-envelope"></i>
                            Email
                        </label>
                        <input type="email" class="form-control" id="email" placeholder="Masukkan email">
                    </div>
                    <button type="submit" class="btn btn-primary btn-block">
                        <i class="fas fa-sign-in-alt"></i>
                        <span id="authButtonText">Login</span>
                    </button>
                    <p class="auth-switch">
                        <span id="authSwitchText">Belum punya akun?</span>
                        <a href="#" onclick="toggleAuth()" class="auth-link">Daftar sekarang</a>
                    </p>
                </form>
            </div>
        </section>

        <!-- ===== USER DASHBOARD ===== -->
        <section id="userDashboard" class="dashboard hidden">
            <div class="dashboard-header card">
                <div class="user-info flex-center gap-4">
                    <div class="user-avatar">
                        <i class="fas fa-user"></i>
                    </div>
                    <div class="user-details">
                        <h3 id="userDisplay">User</h3>
                        <p class="text-secondary">Selamat datang di KAII STORE</p>
                    </div>
                </div>
                <button class="btn btn-secondary" onclick="logout()">
                    <i class="fas fa-sign-out-alt"></i>
                    <span>Logout</span>
                </button>
            </div>

            <!-- User Tabs -->
            <div class="tabs card">
                <div class="tab-list">
                    <button class="tab-button active" onclick="switchUserTab('products')">
                        <i class="fas fa-shopping-bag"></i>
                        <span>Produk</span>
                    </button>
                    <button class="tab-button" onclick="switchUserTab('history')">
                        <i class="fas fa-history"></i>
                        <span>Riwayat</span>
                    </button>
                </div>
            </div>

            <!-- Products Tab -->
            <div id="userProductsTab" class="tab-content active">
                <div class="section-header">
                    <h2>Produk Tersedia</h2>
                    <p class="text-secondary">Pilih produk yang ingin Anda beli</p>
                </div>
                <div class="product-grid" id="productsGrid">
                    <!-- Products will be loaded here -->
                </div>
            </div>

            <!-- Order History Tab -->
            <div id="userHistoryTab" class="tab-content">
                <div class="section-header">
                    <h2>Riwayat Pesanan</h2>
                    <p class="text-secondary">Lihat semua pesanan Anda</p>
                </div>
                <div id="orderHistory">
                    <!-- Order history will be loaded here -->
                </div>
            </div>
        </section>

        <!-- ===== ADMIN DASHBOARD ===== -->
        <section id="adminPanel" class="dashboard hidden">
            <div class="dashboard-header card">
                <div class="user-info flex-center gap-4">
                    <div class="user-avatar admin-avatar">
                        <i class="fas fa-crown"></i>
                    </div>
                    <div class="user-details">
                        <h3>Admin Panel</h3>
                        <p class="text-secondary">Kelola toko Anda</p>
                    </div>
                </div>
                <button class="btn btn-secondary" onclick="logout()">
                    <i class="fas fa-sign-out-alt"></i>
                    <span>Logout</span>
                </button>
            </div>

            <!-- Admin Tabs -->
            <div class="tabs card">
                <div class="tab-list">
                    <button class="tab-button active" onclick="switchTab('products')">
                        <i class="fas fa-box"></i>
                        <span>Produk</span>
                    </button>
                    <button class="tab-button" onclick="switchTab('payments')">
                        <i class="fas fa-credit-card"></i>
                        <span>Payment</span>
                    </button>
                    <button class="tab-button" onclick="switchTab('orders')">
                        <i class="fas fa-shopping-cart"></i>
                        <span>Pesanan</span>
                    </button>
                    <button class="tab-button" onclick="switchTab('users')">
                        <i class="fas fa-users"></i>
                        <span>Users</span>
                    </button>
                </div>
            </div>

            <!-- Products Tab -->
            <div id="productsTab" class="tab-content active">
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">
                            <i class="fas fa-plus-circle"></i>
                            Tambah Produk
                        </h3>
                    </div>
                    <form onsubmit="addProduct(event)">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div class="form-group">
                                <label class="form-label">
                                    <i class="fas fa-tag"></i>
                                    Nama Produk
                                </label>
                                <input type="text" class="form-control" id="productName" required placeholder="Nama produk">
                            </div>
                            <div class="form-group">
                                <label class="form-label">
                                    <i class="fas fa-dollar-sign"></i>
                                    Harga
                                </label>
                                <input type="number" class="form-control" id="productPrice" required placeholder="0" min="0">
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="form-label">
                                <i class="fas fa-cubes"></i>
                                Stok
                            </label>
                            <input type="number" class="form-control" id="productStock" required placeholder="0" min="0">
                        </div>
                        <div class="form-group">
                            <label class="form-label">
                                <i class="fas fa-align-left"></i>
                                Deskripsi
                            </label>
                            <textarea class="form-control" id="productDescription" rows="3" placeholder="Deskripsi produk"></textarea>
                        </div>
                        <div class="form-group">
                            <label class="form-label">
                                <i class="fas fa-image"></i>
                                Foto Produk
                            </label>
                            <div class="file-upload">
                                <input type="file" id="productImage" accept="image/*" onchange="previewImage(event, 'productImagePreview')">
                                <label for="productImage" class="file-upload-label">
                                    <div class="file-upload-icon">
                                        <i class="fas fa-cloud-upload-alt"></i>
                                    </div>
                                    <p>Klik untuk upload foto</p>
                                    <p class="text-small">PNG, JPG max 10MB</p>
                                </label>
                            </div>
                            <img id="productImagePreview" class="image-preview" alt="Preview">
                        </div>
                        <button type="submit" class="btn btn-primary btn-block">
                            <i class="fas fa-plus"></i>
                            Tambah Produk
                        </button>
                    </form>
                </div>

                <div class="section-header">
                    <h3>Daftar Produk</h3>
                    <p class="text-secondary">Kelola produk yang tersedia</p>
                </div>
                <div id="adminProductList">
                    <!-- Product list will be loaded here -->
                </div>
            </div>
            <!-- Payments Tab -->
            <div id="paymentsTab" class="tab-content">
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">
                            <i class="fas fa-plus-circle"></i>
                            Tambah Metode Pembayaran
                        </h3>
                    </div>
                    <form onsubmit="addPaymentMethod(event)">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div class="form-group">
                                <label class="form-label">
                                    <i class="fas fa-credit-card"></i>
                                    Nama Metode
                                </label>
                                <input type="text" class="form-control" id="paymentName" required placeholder="Nama metode">
                            </div>
                            <div class="form-group">
                                <label class="form-label">
                                    <i class="fas fa-hashtag"></i>
                                    Nomor/Rekening
                                </label>
                                <input type="text" class="form-control" id="paymentNumber" required placeholder="Nomor rekening">
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="form-label">
                                <i class="fas fa-image"></i>
                                Foto Metode
                            </label>
                            <div class="file-upload">
                                <input type="file" id="paymentImage" accept="image/*" onchange="previewImage(event, 'paymentImagePreview')">
                                <label for="paymentImage" class="file-upload-label">
                                    <div class="file-upload-icon">
                                        <i class="fas fa-cloud-upload-alt"></i>
                                    </div>
                                    <p>Klik untuk upload foto</p>
                                    <p class="text-small">PNG, JPG max 10MB</p>
                                </label>
                            </div>
                            <img id="paymentImagePreview" class="image-preview" alt="Preview">
                        </div>
                        <button type="submit" class="btn btn-primary btn-block">
                            <i class="fas fa-plus"></i>
                            Tambah Metode
                        </button>
                    </form>
                </div>

                <div class="section-header">
                    <h3>Daftar Metode Pembayaran</h3>
                    <p class="text-secondary">Kelola metode pembayaran yang tersedia</p>
                </div>
                <div id="adminPaymentList">
                    <!-- Payment methods list will be loaded here -->
                </div>
            </div>

            <!-- Orders Tab -->
            <div id="ordersTab" class="tab-content">
                <div class="section-header">
                    <h3>Daftar Pesanan</h3>
                    <p class="text-secondary">Kelola semua pesanan masuk</p>
                </div>
                <div class="table-container card">
                    <div class="table-responsive">
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Pelanggan</th>
                                    <th>Produk</th>
                                    <th>Total</th>
                                    <th>Status</th>
                                    <th>Aksi</th>
                                </tr>
                            </thead>
                            <tbody id="ordersTableBody">
                                <!-- Orders will be loaded here -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Users Tab -->
            <div id="usersTab" class="tab-content">
                <div class="section-header">
                    <h3>Manajemen User</h3>
                    <p class="text-secondary">Kelola semua user terdaftar</p>
                </div>
                <div id="userList">
                    <!-- User list will be loaded here -->
                </div>
            </div>
        </section>
    </main>

    <!-- ===== MODALS ===== -->
    <!-- Purchase Modal -->
    <div id="purchaseModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">
                    <i class="fas fa-shopping-cart"></i>
                    Checkout
                </h3>
                <button class="modal-close" onclick="closeModal('purchaseModal')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div id="purchaseModalBody">
                    <!-- Purchase form will be loaded here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Order Confirmation Modal -->
    <div id="orderModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">
                    <i class="fas fa-clipboard-check"></i>
                    Konfirmasi Pesanan
                </h3>
                <button class="modal-close" onclick="closeModal('orderModal')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div id="orderModalBody">
                    <!-- Order details will be loaded here -->
                </div>
            </div>
        </div>
    </div>

    <!-- ===== TOAST NOTIFICATION ===== -->
    <div id="toast" class="toast">
        <div class="toast-icon">
            <i class="fas fa-check-circle"></i>
        </div>
        <div class="toast-message" id="toastMessage">Notification message</div>
    </div>
    <style>
        /* ===== BUTTONS ===== */
        .btn {
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 0.75rem;
            font-size: 0.875rem;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            text-decoration: none;
            min-height: 2.75rem;
            white-space: nowrap;
            position: relative;
            overflow: hidden;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.2);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }

        .btn:hover::before {
            width: 300px;
            height: 300px;
        }

        .btn:active {
            transform: scale(0.98);
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
            box-shadow: 0 4px 15px rgba(99, 102, 241, 0.3);
        }

        .btn-primary:hover {
            background: linear-gradient(135deg, var(--primary-dark), var(--primary));
            box-shadow: 0 6px 20px rgba(99, 102, 241, 0.4);
            transform: translateY(-2px);
        }

        .btn-secondary {
            background: transparent;
            color: var(--text-primary);
            border: 2px solid var(--border);
        }

        .btn-secondary:hover {
            background: var(--card-bg);
            border-color: var(--primary);
            transform: translateY(-2px);
        }

        .btn-danger {
            background: linear-gradient(135deg, var(--danger), #dc2626);
            color: white;
            box-shadow: 0 4px 15px rgba(239, 68, 68, 0.3);
        }

        .btn-danger:hover {
            background: linear-gradient(135deg, #dc2626, var(--danger));
            box-shadow: 0 6px 20px rgba(239, 68, 68, 0.4);
            transform: translateY(-2px);
        }

        .btn-success {
            background: linear-gradient(135deg, var(--success), #059669);
            color: white;
            box-shadow: 0 4px 15px rgba(16, 185, 129, 0.3);
        }

        .btn-success:hover {
            background: linear-gradient(135deg, #059669, var(--success));
            box-shadow: 0 6px 20px rgba(16, 185, 129, 0.4);
            transform: translateY(-2px);
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none !important;
        }

        .btn-sm {
            padding: 0.5rem 1rem;
            font-size: 0.75rem;
            min-height: 2.25rem;
        }

        .btn-block {
            width: 100%;
            justify-content: center;
        }

        /* ===== AUTH STYLES ===== */
        .auth-container {
            min-height: calc(100vh - 200px);
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 2rem 1rem;
        }

        .auth-card {
            background: var(--card-bg);
            border-radius: 1.25rem;
            padding: 2.5rem;
            width: 100%;
            max-width: 480px;
            border: 1px solid var(--border);
            box-shadow: var(--shadow);
            backdrop-filter: blur(10px);
            animation: fadeInUp 0.6s ease-out;
        }

        .auth-header {
            text-align: center;
            margin-bottom: 2.5rem;
            position: relative;
        }

        .auth-title {
            font-size: 2.25rem;
            font-weight: 700;
            background: linear-gradient(135deg, var(--primary), var(--accent));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 0.75rem;
            animation: pulse 3s infinite;
        }

        .auth-icon {
            font-size: 3.5rem;
            color: var(--primary);
            opacity: 0.9;
            animation: float 4s ease-in-out infinite;
        }

        .auth-switch {
            text-align: center;
            margin-top: 2rem;
            color: var(--text-secondary);
            font-size: 0.95rem;
        }

        .auth-link {
            color: var(--primary);
            text-decoration: none;
            font-weight: 600;
            margin-left: 0.5rem;
            transition: var(--transition);
        }

        .auth-link:hover {
            text-decoration: underline;
            color: var(--accent);
        }

        /* ===== FORM STYLES ===== */
        .form-group {
            margin-bottom: 1.75rem;
            animation: slideInLeft 0.5s ease-out;
        }

        .form-label {
            display: block;
            margin-bottom: 0.75rem;
            font-size: 0.9rem;
            font-weight: 500;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .form-control {
            width: 100%;
            padding: 0.875rem 1.125rem;
            background: rgba(255, 255, 255, 0.08);
            border: 1px solid var(--border);
            border-radius: 0.75rem;
            color: var(--text-primary);
            font-size: 0.9rem;
            transition: var(--transition);
        }

        .form-control:focus {
            outline: none;
            border-color: var(--primary);
            background: rgba(255, 255, 255, 0.12);
            box-shadow: 0 0 0 4px rgba(99, 102, 241, 0.15);
            animation: glow 2s infinite;
        }

        .form-control::placeholder {
            color: var(--text-secondary);
            opacity: 0.7;
        }

        textarea.form-control {
            resize: vertical;
            min-height: 120px;
            font-family: inherit;
        }

        /* ===== FILE UPLOAD ===== */
        .file-upload {
            position: relative;
            display: block;
            width: 100%;
        }

        .file-upload input[type="file"] {
            position: absolute;
            opacity: 0;
            width: 100%;
            height: 100%;
            cursor: pointer;
            z-index: 2;
        }

        .file-upload-label {
            display: block;
            padding: 2.5rem;
            background: rgba(255, 255, 255, 0.08);
            border: 2px dashed var(--border);
            border-radius: 0.75rem;
            text-align: center;
            transition: var(--transition);
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }

        .file-upload-label::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(99, 102, 241, 0.1), transparent);
            transition: left 0.5s;
        }

        .file-upload:hover .file-upload-label::before {
            left: 100%;
        }

        .file-upload:hover .file-upload-label {
            border-color: var(--primary);
            background: rgba(99, 102, 241, 0.15);
            animation: pulse 1s;
        }

        .file-upload-icon {
            font-size: 2.5rem;
            margin-bottom: 0.75rem;
            color: var(--primary);
            animation: float 3s ease-in-out infinite;
        }

        .image-preview {
            max-width: 250px;
            max-height: 250px;
            border-radius: 0.75rem;
            margin-top: 1.25rem;
            display: none;
            width: 100%;
            height: auto;
            box-shadow: var(--shadow);
            animation: fadeIn 0.5s ease-out;
        }

        /* ===== RESPONSIVE FORM ===== */
        @media (max-width: 768px) {
            .auth-card {
                padding: 2rem;
                margin: 1rem;
            }

            .form-group {
                margin-bottom: 1.5rem;
            }

            .form-control {
                padding: 0.75rem 1rem;
                font-size: 0.875rem;
            }

            .btn {
                padding: 0.625rem 1.25rem;
                font-size: 0.8rem;
                min-height: 2.5rem;
            }
        }

        @media (max-width: 480px) {
            .auth-card {
                padding: 1.5rem;
                margin: 0.75rem;
            }

            .form-control {
                padding: 0.625rem 0.875rem;
                font-size: 0.8rem;
            }

            .btn {
                padding: 0.5rem 1rem;
                font-size: 0.75rem;
                min-height: 2.25rem;
            }
        }
    </style>
    <style>
        /* ===== DASHBOARD STYLES ===== */
        .dashboard {
            animation: fadeIn 0.6s ease-out;
        }

        .dashboard-header {
            margin-bottom: 2.5rem;
            padding: 2rem;
            animation: slideInLeft 0.6s ease-out;
        }

        .user-info {
            gap: 1.25rem;
        }

        .user-avatar {
            width: 3.5rem;
            height: 3.5rem;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            color: white;
            box-shadow: 0 4px 15px rgba(99, 102, 241, 0.3);
            animation: pulse 3s infinite;
        }

        .admin-avatar {
            background: linear-gradient(135deg, var(--secondary), var(--accent));
        }

        .user-details h3 {
            font-size: 1.375rem;
            font-weight: 600;
            margin-bottom: 0.375rem;
        }

        .text-secondary {
            color: var(--text-secondary);
            font-size: 0.95rem;
        }

        .text-small {
            font-size: 0.8rem;
            color: var(--text-secondary);
            opacity: 0.8;
        }

        /* ===== TABS STYLES ===== */
        .tabs {
            margin-bottom: 2.5rem;
            padding: 0.625rem;
            animation: fadeInUp 0.7s ease-out;
        }

        .tab-list {
            display: flex;
            gap: 0.625rem;
            flex-wrap: wrap;
        }

        .tab-button {
            padding: 0.875rem 1.5rem;
            background: transparent;
            border: none;
            color: var(--text-secondary);
            cursor: pointer;
            border-radius: 0.75rem;
            transition: var(--transition);
            font-weight: 500;
            flex: 1;
            text-align: center;
            min-width: 130px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            position: relative;
            overflow: hidden;
        }

        .tab-button::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
            transition: left 0.5s;
        }

        .tab-button:hover::before {
            left: 100%;
        }

        .tab-button:hover {
            background: rgba(255, 255, 255, 0.08);
            transform: translateY(-2px);
        }

        .tab-button.active {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
            box-shadow: 0 4px 20px rgba(99, 102, 241, 0.4);
            animation: pulse 2s infinite;
        }

        .tab-content {
            display: none;
            animation: fadeInUp 0.6s ease-out;
        }

        .tab-content.active {
            display: block;
        }

        /* ===== CARD STYLES ===== */
        .card {
            background: var(--card-bg);
            border-radius: 1.25rem;
            padding: 2rem;
            border: 1px solid var(--border);
            transition: var(--transition);
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            animation: fadeInUp 0.6s ease-out;
        }

        .card:hover {
            box-shadow: var(--shadow);
            transform: translateY(-4px);
        }

        .card-header {
            margin-bottom: 2rem;
            padding-bottom: 1.25rem;
            border-bottom: 1px solid var(--border);
        }

        .card-title {
            font-size: 1.375rem;
            font-weight: 600;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: 0.625rem;
        }

        .section-header {
            margin-bottom: 2rem;
            animation: slideInRight 0.6s ease-out;
        }

        .section-header h2 {
            font-size: 1.75rem;
            font-weight: 600;
            margin-bottom: 0.625rem;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        /* ===== PRODUCT GRID ===== */
        .product-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 2rem;
        }

        .product-card {
            background: var(--card-bg);
            border-radius: 1.25rem;
            overflow: hidden;
            border: 1px solid var(--border);
            transition: var(--transition);
            animation: fadeInUp 0.6s ease-out;
            position: relative;
        }

        .product-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, rgba(99, 102, 241, 0.1), rgba(236, 72, 153, 0.1));
            opacity: 0;
            transition: opacity 0.3s;
        }

        .product-card:hover::before {
            opacity: 1;
        }

        .product-card:hover {
            transform: translateY(-8px);
            box-shadow: var(--shadow);
            animation: bounce 1s;
        }

        .product-image {
            width: 100%;
            height: 220px;
            object-fit: cover;
            background: linear-gradient(135deg, rgba(99, 102, 241, 0.2), rgba(236, 72, 153, 0.2));
            transition: var(--transition);
        }

        .product-card:hover .product-image {
            transform: scale(1.05);
        }

        .product-content {
            padding: 2rem;
        }

        .product-name {
            font-size: 1.25rem;
            font-weight: 600;
            margin-bottom: 0.75rem;
        }

        .product-price {
            font-size: 1.625rem;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 0.75rem;
            animation: pulse 3s infinite;
        }

        .product-stock {
            font-size: 0.9rem;
            color: var(--text-secondary);
            margin-bottom: 1.25rem;
            padding: 0.375rem 0.75rem;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 0.5rem;
            display: inline-block;
        }

        .product-description {
            font-size: 0.9rem;
            color: var(--text-secondary);
            margin-bottom: 1.5rem;
            line-height: 1.6;
        }

        /* ===== ADMIN ITEMS ===== */
        .admin-item {
            background: var(--card-bg);
            border-radius: 1.25rem;
            padding: 2rem;
            margin-bottom: 1.25rem;
            border: 1px solid var(--border);
            transition: var(--transition);
            animation: slideInLeft 0.6s ease-out;
            position: relative;
        }

        .admin-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, rgba(99, 102, 241, 0.05), transparent);
            opacity: 0;
            transition: opacity 0.3s;
        }

        .admin-item:hover::before {
            opacity: 1;
        }

        .admin-item:hover {
            border-color: var(--primary);
            transform: translateX(8px);
            box-shadow: var(--shadow);
        }

        .admin-item-header {
            display: flex;
            align-items: center;
            gap: 1.25rem;
            margin-bottom: 1.25rem;
        }

        .admin-item-image {
            width: 90px;
            height: 90px;
            border-radius: 0.75rem;
            object-fit: cover;
            transition: var(--transition);
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
        }

        .admin-item:hover .admin-item-image {
            transform: scale(1.05);
        }

        .admin-item-info {
            flex: 1;
        }

        .admin-item-title {
            font-size: 1.25rem;
            font-weight: 600;
            margin-bottom: 0.375rem;
        }

        .admin-item-meta {
            font-size: 0.9rem;
            color: var(--text-secondary);
            line-height: 1.5;
        }

        .admin-item-actions {
            display: flex;
            gap: 0.75rem;
            margin-top: 1.25rem;
        }

        /* ===== RESPONSIVE DASHBOARD ===== */
        @media (max-width: 768px) {
            .dashboard-header {
                flex-direction: column;
                gap: 1.25rem;
                text-align: center;
                padding: 1.5rem;
            }

            .user-info {
                flex-direction: column;
                text-align: center;
            }

            .tab-button {
                min-width: 110px;
                font-size: 0.875rem;
                padding: 0.75rem 1.25rem;
            }

            .product-grid {
                grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
                gap: 1.5rem;
            }

            .admin-item-header {
                flex-direction: column;
                text-align: center;
            }

            .admin-item-actions {
                justify-content: center;
            }
        }

        @media (max-width: 480px) {
            .product-grid {
                grid-template-columns: 1fr;
            }

            .tab-list {
                flex-direction: column;
            }

            .tab-button {
                min-width: auto;
            }

            .admin-item {
                padding: 1.5rem;
            }
        }
    </style>
    <style>
        /* ===== TABLE STYLES ===== */
        .table-container {
            overflow-x: auto;
            animation: fadeInUp 0.6s ease-out;
            border-radius: 1.25rem;
            box-shadow: var(--shadow);
        }

        .table {
            width: 100%;
            border-collapse: collapse;
            background: var(--card-bg);
        }

        .table th,
        .table td {
            padding: 1.25rem;
            text-align: left;
            border-bottom: 1px solid var(--border);
        }

        .table th {
            background: linear-gradient(135deg, rgba(99, 102, 241, 0.15), rgba(139, 92, 246, 0.15));
            font-weight: 600;
            color: var(--primary);
            font-size: 0.875rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            position: relative;
        }

        .table th::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 2px;
            background: linear-gradient(90deg, var(--primary), var(--secondary));
        }

        .table tbody tr {
            transition: var(--transition);
            position: relative;
        }

        .table tbody tr::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 3px;
            background: var(--primary);
            transform: scaleY(0);
            transition: transform 0.3s;
        }

        .table tbody tr:hover {
            background: rgba(255, 255, 255, 0.03);
            transform: scale(1.01);
        }

        .table tbody tr:hover::before {
            transform: scaleY(1);
        }

        /* ===== BADGES ===== */
        .badge {
            display: inline-flex;
            align-items: center;
            gap: 0.375rem;
            padding: 0.375rem 0.875rem;
            border-radius: 9999px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            animation: pulse 2s infinite;
        }

        .badge i {
            font-size: 0.625rem;
        }

        .badge-pending {
            background: linear-gradient(135deg, rgba(239, 68, 68, 0.2), rgba(220, 38, 38, 0.2));
            color: var(--danger);
            border: 1px solid rgba(239, 68, 68, 0.3);
        }

        .badge-completed {
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.2), rgba(5, 150, 105, 0.2));
            color: var(--success);
            border: 1px solid rgba(16, 185, 129, 0.3);
        }

        /* ===== ORDER ITEMS ===== */
        .order-item {
            background: var(--card-bg);
            border-radius: 1.25rem;
            padding: 2rem;
            margin-bottom: 1.25rem;
            border: 1px solid var(--border);
            border-left: 4px solid transparent;
            transition: var(--transition);
            animation: slideInLeft 0.6s ease-out;
            position: relative;
        }

        .order-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, rgba(99, 102, 241, 0.05), transparent);
            opacity: 0;
            transition: opacity 0.3s;
        }

        .order-item:hover::before {
            opacity: 1;
        }

        .order-item:hover {
            border-left-color: var(--primary);
            transform: translateX(8px);
            box-shadow: var(--shadow);
        }

        .order-item.completed {
            border-left-color: var(--success);
        }

        .order-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 1.25rem;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .order-info h4 {
            font-size: 1.25rem;
            font-weight: 600;
            margin-bottom: 0.375rem;
        }

        .order-date {
            font-size: 0.875rem;
            color: var(--text-secondary);
        }

        .order-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-bottom: 1.25rem;
        }

        .order-detail-item {
            font-size: 0.875rem;
        }

        .order-detail-label {
            font-weight: 600;
            color: var(--text-secondary);
            margin-bottom: 0.375rem;
        }

        /* ===== REDEEM CODE ===== */
        .redeem-box {
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.15), rgba(5, 150, 105, 0.15));
            border: 1px solid rgba(16, 185, 129, 0.3);
            border-radius: 0.75rem;
            padding: 1.25rem;
            margin-top: 1.25rem;
            position: relative;
            animation: fadeInUp 0.6s ease-out;
        }

        .redeem-label {
            font-weight: 600;
            color: var(--success);
            margin-bottom: 0.625rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .redeem-code {
            font-family: 'Courier New', monospace;
            font-size: 1rem;
            color: var(--success);
            word-break: break-all;
            background: rgba(0, 0, 0, 0.3);
            padding: 0.75rem;
            border-radius: 0.5rem;
            animation: glow 3s infinite;
        }

        .copy-button {
            position: absolute;
            top: 0.75rem;
            right: 0.75rem;
            background: var(--success);
            border: none;
            color: white;
            padding: 0.375rem 0.625rem;
            border-radius: 0.375rem;
            cursor: pointer;
            font-size: 0.75rem;
            transition: var(--transition);
        }

        .copy-button:hover {
            transform: scale(1.05);
            animation: pulse 1s;
        }

        /* ===== MODAL STYLES ===== */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 2000;
            align-items: center;
            justify-content: center;
            padding: 1rem;
            backdrop-filter: blur(5px);
        }

        .modal.active {
            display: flex;
            animation: fadeIn 0.3s ease-out;
        }

        .modal-content {
            background: var(--card-bg);
            border-radius: 1.25rem;
            padding: 2.5rem;
            max-width: 650px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            border: 1px solid var(--border);
            animation: slideUp 0.4s ease-out;
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.5);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
            padding-bottom: 1.25rem;
            border-bottom: 1px solid var(--border);
        }

        .modal-title {
            font-size: 1.625rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 0.625rem;
        }

        .modal-close {
            background: none;
            border: none;
            color: var(--text-secondary);
            font-size: 1.625rem;
            cursor: pointer;
            transition: var(--transition);
            width: 2.25rem;
            height: 2.25rem;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 0.5rem;
        }

        .modal-close:hover {
            background: rgba(255, 255, 255, 0.1);
            color: var(--text-primary);
            transform: rotate(90deg);
        }

        .modal-body {
            max-height: 60vh;
            overflow-y: auto;
        }

        /* ===== PAYMENT METHODS ===== */
        .payment-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
            gap: 1.25rem;
            margin-top: 1.25rem;
        }

        .payment-method {
            background: rgba(255, 255, 255, 0.08);
            border: 2px solid transparent;
            border-radius: 0.75rem;
            padding: 1.25rem;
            cursor: pointer;
            transition: var(--transition);
            text-align: center;
            animation: fadeInUp 0.6s ease-out;
            position: relative;
        }

        .payment-method::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, rgba(99, 102, 241, 0.1), transparent);
            opacity: 0;
            transition: opacity 0.3s;
        }

        .payment-method:hover::before {
            opacity: 1;
        }

        .payment-method:hover {
            border-color: var(--primary);
            transform: translateY(-5px);
            box-shadow: var(--shadow);
        }

        .payment-method.selected {
            border-color: var(--primary);
            background: rgba(99, 102, 241, 0.2);
            animation: pulse 2s infinite;
        }

        .payment-image {
            width: 70px;
            height: 70px;
            border-radius: 0.75rem;
            object-fit: cover;
            margin-bottom: 0.625rem;
            transition: var(--transition);
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
        }

        .payment-method:hover .payment-image {
            transform: scale(1.1);
        }

        .payment-name {
            font-weight: 600;
            margin-bottom: 0.375rem;
        }

        .payment-number {
            font-size: 0.75rem;
            color: var(--text-secondary);
        }

        /* ===== RESPONSIVE TABLE ===== */
        @media (max-width: 768px) {
            .table-container {
                font-size: 0.875rem;
            margin: 0 -1rem;
            border-radius: 0;
            box-shadow: none;
            border-left: 3px solid var(--border);
                border-right: 3px solid var(--border);
            }

            .table th,
            .table td {
                padding: 0.75rem;
            }

            .table th:nth-child(3),
            .table td:nth-child(3) {
                display: none;
            }

            .order-details {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 480px) {
            .table th:nth-child(2),
            .table td:nth-child(2),
            .table th:nth-child(4),
            .table td:nth-child(4) {
                display: none;
            }

            .order-header {
                flex-direction: column;
                align-items: flex-start;
            }
        }
    </style>
    <style>
        /* ===== PAYMENT PROOF ===== */
        .payment-proof {
            margin: 2rem 0;
            text-align: center;
        }

        .payment-proof img {
            max-width: 100%;
            max-height: 350px;
            border-radius: 0.75rem;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            transition: var(--transition);
        }

        .payment-proof img:hover {
            transform: scale(1.02);
        }

        .proof-label {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            background: linear-gradient(135deg, rgba(239, 68, 68, 0.2), rgba(220, 38, 38, 0.2));
            color: var(--danger);
            padding: 0.375rem 0.875rem;
            border-radius: 9999px;
            font-size: 0.75rem;
            font-weight: 600;
            margin-bottom: 1.25rem;
            animation: pulse 2s infinite;
        }

        /* ===== EMPTY STATES ===== */
        .empty-state {
            text-align: center;
            padding: 5rem 2rem;
            color: var(--text-secondary);
        }

        .empty-icon {
            font-size: 4.5rem;
            margin-bottom: 1.25rem;
            opacity: 0.3;
            animation: float 4s ease-in-out infinite;
        }

        .empty-title {
            font-size: 1.625rem;
            font-weight: 600;
            margin-bottom: 0.625rem;
            color: var(--text-primary);
        }

        .empty-description {
            font-size: 1rem;
            line-height: 1.6;
        }

        /* ===== TOAST NOTIFICATION ===== */
        .toast {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            background: var(--card-bg);
            color: white;
            padding: 1.25rem 1.75rem;
            border-radius: 0.75rem;
            box-shadow: var(--shadow);
            transform: translateX(400px);
            transition: transform 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            z-index: 3000;
            display: flex;
            align-items: center;
            gap: 0.875rem;
            max-width: 400px;
            border: 1px solid var(--border);
            backdrop-filter: blur(10px);
        }

        .toast.show {
            transform: translateX(0);
            animation: slideInRight 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }

        .toast.error {
            background: linear-gradient(135deg, var(--danger), #dc2626);
            border-color: var(--danger);
        }

        .toast.success {
            background: linear-gradient(135deg, var(--success), #059669);
            border-color: var(--success);
        }

        .toast-icon {
            font-size: 1.375rem;
            animation: pulse 2s infinite;
        }

        .toast-message {
            flex: 1;
            font-weight: 500;
        }

        /* ===== QUANTITY SELECTOR ===== */
        .quantity-selector {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            margin-bottom: 1.25rem;
        }

        .quantity-btn {
            width: 2.75rem;
            height: 2.75rem;
            border-radius: 0.75rem;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid var(--border);
            color: var(--text-primary);
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .quantity-btn:hover {
            background: var(--primary);
            border-color: var(--primary);
            transform: scale(1.1);
        }

        .quantity-btn:active {
            transform: scale(0.95);
        }

        .quantity-input {
            width: 4.5rem;
            text-align: center;
            background: rgba(255, 255, 255, 0.08);
            border: 1px solid var(--border);
            border-radius: 0.75rem;
            color: var(--text-primary);
            padding: 0.625rem;
            font-size: 1rem;
            font-weight: 600;
        }

        .quantity-input:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.2);
        }

        /* ===== LOADING STATES ===== */
        .loading {
            display: inline-block;
            width: 1.25rem;
            height: 1.25rem;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: var(--primary);
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }

        .skeleton {
            background: linear-gradient(90deg, rgba(255, 255, 255, 0.05) 25%, rgba(255, 255, 255, 0.1) 50%, rgba(255, 255, 255, 0.05) 75%);
            background-size: 200% 100%;
            animation: loading 1.5s infinite;
            border-radius: 0.5rem;
        }

        @keyframes loading {
            0% {
                background-position: 200% 0;
            }
            100% {
                background-position: -200% 0;
            }
        }

        /* ===== UTILITY CLASSES ===== */
        .hidden {
            display: none !important;
        }

        .text-center {
            text-align: center;
        }

        .fade-in {
            animation: fadeIn 0.5s ease-out;
        }

        .slide-up {
            animation: slideInUp 0.5s ease-out;
        }

        .slide-left {
            animation: slideInLeft 0.5s ease-out;
        }

        .slide-right {
            animation: slideInRight 0.5s ease-out;
        }

        .pulse {
            animation: pulse 2s infinite;
        }

        .bounce {
            animation: bounce 1s;
        }

        .float {
            animation: float 3s ease-in-out infinite;
        }

        .glow {
            animation: glow 2s infinite;
        }

        /* ===== GRID SYSTEM ===== */
        .grid-cols-1 { grid-template-columns: 1fr; }
        .grid-cols-2 { grid-template-columns: repeat(2, 1fr); }
        .grid-cols-3 { grid-template-columns: repeat(3, 1fr); }
        .grid-cols-4 { grid-template-columns: repeat(4, 1fr); }

        /* ===== RESPONSIVE DESIGN ===== */
        @media (max-width: 768px) {
            .container {
                padding: 0 0.75rem;
            }

            .toast {
                bottom: 1rem;
                right: 1rem;
                left: 1rem;
                max-width: none;
            }

            .modal-content {
                padding: 2rem;
                margin: 1rem;
            }

            .empty-state {
                padding: 3rem 1.5rem;
            }

            .empty-icon {
                font-size: 3.5rem;
            }

            .payment-proof img {
                max-height: 250px;
            }
        }

        @media (max-width: 480px) {
            .grid-cols-1.md\:grid-cols-2 {
                grid-template-columns: 1fr;
            }

            .modal-content {
                padding: 1.5rem;
            }

            .card {
                padding: 1.5rem;
            }

            .product-card {
                margin-bottom: 1rem;
            }

            .admin-item {
                padding: 1.5rem;
            }

            .order-item {
                padding: 1.5rem;
            }
        }

        /* ===== ACCESSIBILITY ===== */
        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border: 0;
        }

        /* Focus styles for better accessibility */
        .btn:focus,
        .form-control:focus,
        .tab-button:focus,
        .modal-close:focus {
            outline: 2px solid var(--primary);
            outline-offset: 2px;
        }

        /* Reduced motion for users who prefer it */
        @media (prefers-reduced-motion: reduce) {
            *,
            *::before,
            *::after {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
        }

        /* High contrast mode support */
        @media (prefers-contrast: high) {
            :root {
                --border: #ffffff;
                --text-secondary: #cccccc;
            }
        }

        /* Dark mode enhancements */
        @media (prefers-color-scheme: dark) {
            :root {
                --card-bg: #2d3748;
                --border: #4a5568;
            }
        }
    </style>
    <script>
        // ===== DATA STORAGE =====
        let currentUser = null;
        let products = [];
        let paymentMethods = [];
        let orders = [];
        let users = [];
        let selectedProduct = null;
        let selectedPaymentId = null;

        // ===== INITIALIZATION =====
        document.addEventListener('DOMContentLoaded', function() {
            console.log(' KAII STORE initialized');
            initializeApp();
        });

        function initializeApp() {
            try {
                loadData();
                checkAuth();
                setupEventListeners();
                console.log(' App initialized successfully');
            } catch (error) {
                console.error(' Error initializing app:', error);
                showToast('Error initializing app', 'error');
            }
        }

        // ===== DATA MANAGEMENT =====
        function loadData() {
            try {
                const savedProducts = localStorage.getItem('kaii_products');
                const savedPayments = localStorage.getItem('kaii_payments');
                const savedOrders = localStorage.getItem('kaii_orders');
                const savedUsers = localStorage.getItem('kaii_users');

                if (savedProducts) {
                    products = JSON.parse(savedProducts);
                    console.log(' Loaded', products.length, 'products');
                } else {
                    products = [];
                    saveData();
                }

                if (savedPayments) {
                    paymentMethods = JSON.parse(savedPayments);
                    console.log(' Loaded', paymentMethods.length, 'payment methods');
                } else {
                    paymentMethods = [];
                    saveData();
                }

                if (savedOrders) {
                    orders = JSON.parse(savedOrders);
                    console.log(' Loaded', orders.length, 'orders');
                }

                if (savedUsers) {
                    users = JSON.parse(savedUsers);
                    console.log(' Loaded', users.length, 'users');
                }

                console.log(' Data loaded successfully');
            } catch (error) {
                console.error(' Error loading data:', error);
                showToast('Error loading data', 'error');
            }
        }

        function saveData() {
            try {
                localStorage.setItem('kaii_products', JSON.stringify(products));
                localStorage.setItem('kaii_payments', JSON.stringify(paymentMethods));
                localStorage.setItem('kaii_orders', JSON.stringify(orders));
                localStorage.setItem('kaii_users', JSON.stringify(users));
                console.log(' Data saved successfully');
            } catch (error) {
                console.error(' Error saving data:', error);
                showToast('Error saving data', 'error');
            }
        }

        // ===== AUTHENTICATION =====
        function checkAuth() {
            const savedUser = localStorage.getItem('kaii_currentUser');
            if (savedUser) {
                try {
                    currentUser = JSON.parse(savedUser);
                    console.log(' User found:', currentUser.username, 'Role:', currentUser.role);
                    
                    if (currentUser.role === 'admin') {
                        showAdminPanel();
                    } else {
                        showUserDashboard();
                    }
                } catch (error) {
                    console.error(' Error parsing user data:', error);
                    logout();
                }
            } else {
                console.log(' No user found, showing login');
                showLogin();
            }
        }

        function showLogin() {
            console.log(' Showing login screen');
            hideAllSections();
            document.getElementById('authSection').classList.remove('hidden');
            document.getElementById('authTitle').textContent = 'Login';
            document.getElementById('authButtonText').textContent = 'Login';
            document.getElementById('authSwitchText').textContent = 'Belum punya akun?';
            document.getElementById('emailGroup').classList.add('hidden');
            document.getElementById('navMenu').style.display = 'flex';
            
            // Clear form
            document.getElementById('authForm').reset();
        }

        function showRegister() {
            console.log(' Showing register screen');
            hideAllSections();
            document.getElementById('authSection').classList.remove('hidden');
            document.getElementById('authTitle').textContent = 'Register';
            document.getElementById('authButtonText').textContent = 'Register';
            document.getElementById('authSwitchText').textContent = 'Sudah punya akun?';
            document.getElementById('emailGroup').classList.remove('hidden');
            document.getElementById('navMenu').style.display = 'flex';
            
            // Clear form
            document.getElementById('authForm').reset();
        }

        function toggleAuth() {
            const isLogin = document.getElementById('authTitle').textContent === 'Login';
            console.log(' Toggling auth:', isLogin ? 'to register' : 'to login');
            
            if (isLogin) {
                showRegister();
            } else {
                showLogin();
            }
        }

        function handleAuth(event) {
            event.preventDefault();
            
            const username = document.getElementById('username').value.trim();
            const password = document.getElementById('password').value;
            const email = document.getElementById('email').value.trim();
            const isLogin = document.getElementById('authTitle').textContent === 'Login';

            console.log(' Auth attempt:', { username, isLogin });

            // Validation
            if (!username || !password) {
                showToast('Username dan password harus diisi', 'error');
                shakeElement(document.getElementById('authForm'));
                return;
            }

            if (isLogin) {
                // Login logic
                if (username === 'admin' && password === 'admin123') {
                    currentUser = { username: 'admin', role: 'admin' };
                    localStorage.setItem('kaii_currentUser', JSON.stringify(currentUser));
                    showAdminPanel();
                    showToast(' Login berhasil sebagai Admin!', 'success');
                } else {
                    const user = users.find(u => u.username === username && u.password === password);
                    if (user) {
                        currentUser = { username: user.username, role: 'user' };
                        localStorage.setItem('kaii_currentUser', JSON.stringify(currentUser));
                        showUserDashboard();
                        showToast(' Login berhasil!', 'success');
                    } else {
                        showToast(' Username atau password salah!', 'error');
                        shakeElement(document.getElementById('authForm'));
                    }
                }
            } else {
                // Register logic
                if (!email) {
                    showToast('Email harus diisi', 'error');
                    shakeElement(document.getElementById('emailGroup'));
                    return;
                }

                if (!validateEmail(email)) {
                    showToast('Format email tidak valid', 'error');
                    shakeElement(document.getElementById('email'));
                    return;
                }

                if (users.find(u => u.username === username)) {
                    showToast(' Username sudah digunakan!', 'error');
                    shakeElement(document.getElementById('username'));
                    return;
                }

                users.push({ 
                    username, 
                    password, 
                    email, 
                    registeredAt: new Date().toISOString(),
                    totalOrders: 0,
                    totalSpent: 0
                });
                saveData();
                showToast(' Registrasi berhasil! Silakan login.', 'success');
                showLogin();
            }
        }

        function validateEmail(email) {
            const re = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            return re.test(email);
        }

        function logout() {
            console.log(' Logging out');
            currentUser = null;
            localStorage.removeItem('kaii_currentUser');
            showLogin();
            showToast(' Logout berhasil!', 'success');
        }

        // ===== DASHBOARD MANAGEMENT =====
        function hideAllSections() {
            document.getElementById('authSection').classList.add('hidden');
            document.getElementById('userDashboard').classList.add('hidden');
            document.getElementById('adminPanel').classList.add('hidden');
        }

        function showUserDashboard() {
            console.log(' Showing user dashboard for:', currentUser.username);
            hideAllSections();
            document.getElementById('userDashboard').classList.remove('hidden');
            document.getElementById('userDisplay').textContent = currentUser.username;
            document.getElementById('navMenu').style.display = 'none';
            loadProducts();
            loadOrderHistory();
        }

        function showAdminPanel() {
            console.log(' Showing admin panel');
            hideAllSections();
            document.getElementById('adminPanel').classList.remove('hidden');
            document.getElementById('navMenu').style.display = 'none';
            loadOrders();
            loadAdminProductList();
            loadAdminPaymentList();
            loadUserList();
        }

        // ===== TAB MANAGEMENT =====
        function switchUserTab(tabName) {
            console.log(' Switching user tab to:', tabName);
            
            // Remove active class from all tabs and contents
            document.querySelectorAll('#userDashboard .tab-button').forEach(btn => {
                btn.classList.remove('active');
            });
            document.querySelectorAll('#userDashboard .tab-content').forEach(content => {
                content.classList.remove('active');
            });

            // Add active class to clicked tab and corresponding content
            event.target.classList.add('active');
            const contentElement = document.getElementById('user' + tabName.charAt(0).toUpperCase() + tabName.slice(1) + 'Tab');
            if (contentElement) {
                contentElement.classList.add('active');
            }

            if (tabName === 'history') {
                loadOrderHistory();
            }
        }

        function switchTab(tabName) {
            console.log(' Switching admin tab to:', tabName);
            
            // Remove active class from all tabs and contents
            document.querySelectorAll('#adminPanel .tab-button').forEach(btn => {
                btn.classList.remove('active');
            });
            document.querySelectorAll('#adminPanel .tab-content').forEach(content => {
                content.classList.remove('active');
            });

            // Add active class to clicked tab and corresponding content
            event.target.classList.add('active');
            const contentElement = document.getElementById(tabName + 'Tab');
            if (contentElement) {
                contentElement.classList.add('active');
            }

            switch(tabName) {
                case 'orders':
                    loadOrders();
                    break;
                case 'products':
                    loadAdminProductList();
                    break;
                case 'payments':
                    loadAdminPaymentList();
                    break;
                case 'users':
                    loadUserList();
                    break;
            }
        }

        // ===== UTILITY FUNCTIONS =====
        function shakeElement(element) {
            element.classList.add('animate-shake');
            setTimeout(() => {
                element.classList.remove('animate-shake');
            }, 500);
        }

        function setupEventListeners() {
            // Close modals when clicking outside
            document.addEventListener('click', function(event) {
                if (event.target.classList.contains('modal')) {
                    event.target.classList.remove('active');
                }
            });

            // Prevent form resubmission on page refresh
            if (window.history.replaceState) {
                window.history.replaceState(null, null, window.location.href);
            }

            // Add keyboard shortcuts
            document.addEventListener('keydown', function(event) {
                if (event.key === 'Escape') {
                    // Close any open modal
                    document.querySelectorAll('.modal.active').forEach(modal => {
                        modal.classList.remove('active');
                    });
                }
            });

            console.log(' Event listeners setup complete');
        }

        console.log(' Auth and dashboard functions loaded');
    </script>
    <script>
        // ===== PRODUCT MANAGEMENT =====
        function loadProducts() {
            console.log(' Loading products...');
            const grid = document.getElementById('productsGrid');
            grid.innerHTML = '';
            
            if (products.length === 0) {
                grid.innerHTML = `
                    <div class="empty-state" style="grid-column: 1/-1;">
                        <div class="empty-icon">
                            <i class="fas fa-box-open"></i>
                        </div>
                        <h3 class="empty-title">Belum ada produk</h3>
                        <p class="empty-description">Silakan tambahkan produk terlebih dahulu</p>
                    </div>
                `;
                return;
            }
            
            products.forEach((product, index) => {
                const card = document.createElement('div');
                card.className = 'product-card';
                card.style.animationDelay = `${index * 0.1}s`;
                card.innerHTML = `
                    <img src="${product.image}" alt="${product.name}" class="product-image">
                    <div class="product-content">
                        <h3 class="product-name">${product.name}</h3>
                        <p class="product-price">Rp ${product.price.toLocaleString('id-ID')}</p>
                        <p class="product-stock">Stok: ${product.stock}</p>
                        <p class="product-description">${product.description}</p>
                        <button class="btn btn-primary btn-block" onclick="openPurchaseModal(${product.id})" ${product.stock === 0 ? 'disabled' : ''}>
                            <i class="fas fa-shopping-cart"></i>
                            <span>${product.stock === 0 ? 'Stok Habis' : 'Beli Sekarang'}</span>
                        </button>
                    </div>
                `;
                grid.appendChild(card);
            });
            
            console.log(' Products loaded:', products.length);
        }

        function loadAdminProductList() {
            console.log(' Loading admin product list...');
            const listContainer = document.getElementById('adminProductList');
            listContainer.innerHTML = '';
            
            if (products.length === 0) {
                listContainer.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-icon">
                            <i class="fas fa-box-open"></i>
                        </div>
                        <h3 class="empty-title">Belum ada produk</h3>
                        <p class="empty-description">Tambahkan produk menggunakan form di atas</p>
                    </div>
                `;
                return;
            }
            
            products.forEach((product, index) => {
                const item = document.createElement('div');
                item.className = 'admin-item';
                item.style.animationDelay = `${index * 0.1}s`;
                item.innerHTML = `
                    <div class="admin-item-header">
                        <img src="${product.image}" alt="${product.name}" class="admin-item-image">
                        <div class="admin-item-info">
                            <h4 class="admin-item-title">${product.name}</h4>
                            <p class="admin-item-meta">Rp ${product.price.toLocaleString('id-ID')}  Stok: ${product.stock}</p>
                            <p class="admin-item-meta" style="margin-top: 0.375rem;">${product.description}</p>
                        </div>
                    </div>
                    <div class="admin-item-actions">
                        <button class="btn btn-danger btn-sm" onclick="deleteProduct(${product.id})">
                            <i class="fas fa-trash"></i>
                            <span>Hapus</span>
                        </button>
                    </div>
                `;
                listContainer.appendChild(item);
            });
            
            console.log(' Admin product list loaded:', products.length);
        }

        function addProduct(event) {
            event.preventDefault();
            
            const name = document.getElementById('productName').value.trim();
            const price = parseInt(document.getElementById('productPrice').value);
            const stock = parseInt(document.getElementById('productStock').value);
            const description = document.getElementById('productDescription').value.trim();
            const imagePreview = document.getElementById('productImagePreview');
            
            console.log(' Adding product:', { name, price, stock, description });
            
            // Validation
            if (!name || !price || !stock || !description) {
                showToast(' Semua field harus diisi', 'error');
                return;
            }

            if (price < 0) {
                showToast(' Harga tidak boleh negatif', 'error');
                return;
            }

            if (stock < 0) {
                showToast(' Stok tidak boleh negatif', 'error');
                return;
            }

            const product = {
                id: Date.now(),
                name,
                price,
                stock,
                description,
                image: imagePreview.src && imagePreview.style.display !== 'none' ? imagePreview.src : `https://picsum.photos/seed/${Date.now()}/300/200`
            };

            products.push(product);
            saveData();
            showToast(' Produk berhasil ditambahkan!', 'success');
            
            // Reset form
            event.target.reset();
            imagePreview.style.display = 'none';
            loadAdminProductList();
        }

        function deleteProduct(productId) {
            const product = products.find(p => p.id === productId);
            if (!product) {
                showToast(' Produk tidak ditemukan', 'error');
                return;
            }

            console.log(' Deleting product:', product.name);

            if (confirm(`Apakah Anda yakin ingin menghapus produk "${product.name}"?`)) {
                products = products.filter(p => p.id !== productId);
                
                // Also remove any pending orders for this product
                const pendingOrders = orders.filter(o => o.productId === productId && o.status === 'pending');
                if (pendingOrders.length > 0) {
                    if (confirm(`Terdapat ${pendingOrders.length} pesanan pending untuk produk ini. Apakah tetap ingin menghapus?`)) {
                        orders = orders.filter(o => o.productId !== productId);
                    } else {
                        // Restore the product
                        products.push(product);
                        showToast(' Produk tidak dihapus karena ada pesanan pending', 'warning');
                        return;
                    }
                }
                
                saveData();
                loadAdminProductList();
                showToast(' Produk berhasil dihapus!', 'success');
            }
        }

        // ===== PAYMENT METHODS =====
        function loadAdminPaymentList() {
            console.log(' Loading admin payment list...');
            const listContainer = document.getElementById('adminPaymentList');
            listContainer.innerHTML = '';
            
            if (paymentMethods.length === 0) {
                listContainer.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-icon">
                            <i class="fas fa-credit-card"></i>
                        </div>
                        <h3 class="empty-title">Belum ada metode pembayaran</h3>
                        <p class="empty-description">Tambahkan metode pembayaran menggunakan form di atas</p>
                    </div>
                `;
                return;
            }
            
            paymentMethods.forEach((method, index) => {
                const item = document.createElement('div');
                item.className = 'admin-item';
                item.style.animationDelay = `${index * 0.1}s`;
                item.innerHTML = `
                    <div class="admin-item-header">
                        <img src="${method.image}" alt="${method.name}" class="admin-item-image">
                        <div class="admin-item-info">
                            <h4 class="admin-item-title">${method.name}</h4>
                            <p class="admin-item-meta">${method.number}</p>
                        </div>
                    </div>
                    <div class="admin-item-actions">
                        <button class="btn btn-danger btn-sm" onclick="deletePaymentMethod(${method.id})">
                            <i class="fas fa-trash"></i>
                            <span>Hapus</span>
                        </button>
                    </div>
                `;
                listContainer.appendChild(item);
            });
            
            console.log(' Admin payment list loaded:', paymentMethods.length);
        }

        function addPaymentMethod(event) {
            event.preventDefault();
            
            const name = document.getElementById('paymentName').value.trim();
            const number = document.getElementById('paymentNumber').value.trim();
            const imagePreview = document.getElementById('paymentImagePreview');
            
            console.log(' Adding payment method:', { name, number });
            
            // Validation
            if (!name || !number) {
                showToast(' Semua field harus diisi', 'error');
                return;
            }

            const method = {
                id: Date.now(),
                name,
                number,
                image: imagePreview.src && imagePreview.style.display !== 'none' ? imagePreview.src : `https://picsum.photos/seed/${Date.now()}/150/150`
            };

            paymentMethods.push(method);
            saveData();
            showToast(' Metode pembayaran berhasil ditambahkan!', 'success');
            
            // Reset form
            event.target.reset();
            imagePreview.style.display = 'none';
            loadAdminPaymentList();
        }

        function deletePaymentMethod(paymentId) {
            const method = paymentMethods.find(p => p.id === paymentId);
            if (!method) {
                showToast(' Metode pembayaran tidak ditemukan', 'error');
                return;
            }

            console.log(' Deleting payment method:', method.name);

            // Check if there are any pending orders using this payment method
            const pendingOrders = orders.filter(o => o.paymentMethod === method.name && o.status === 'pending');
            if (pendingOrders.length > 0) {
                if (confirm(`Terdapat ${pendingOrders.length} pesanan pending menggunakan metode ini. Apakah tetap ingin menghapus?`)) {
                    orders = orders.filter(o => o.paymentMethod !== method.name);
                } else {
                    showToast(' Metode pembayaran tidak dihapus karena ada pesanan pending', 'warning');
                    return;
                }
            }

            if (confirm(`Apakah Anda yakin ingin menghapus metode pembayaran "${method.name}"?`)) {
                paymentMethods = paymentMethods.filter(p => p.id !== paymentId);
                saveData();
                loadAdminPaymentList();
                showToast(' Metode pembayaran berhasil dihapus!', 'success');
            }
        }

        console.log(' Product management functions loaded');
    </script>
    <script>
        // ===== ORDER MANAGEMENT =====
        function loadOrderHistory() {
            console.log(' Loading order history for:', currentUser.username);
            const historyContainer = document.getElementById('orderHistory');
            const userOrders = orders.filter(order => order.userId === currentUser.username);
            
            if (userOrders.length === 0) {
                historyContainer.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-icon">
                            <i class="fas fa-receipt"></i>
                        </div>
                        <h3 class="empty-title">Belum ada pesanan</h3>
                        <p class="empty-description">Anda belum melakukan pesanan apapun</p>
                    </div>
                `;
                return;
            }

            historyContainer.innerHTML = '';
            userOrders.sort((a, b) => new Date(b.date) - new Date(a.date)).forEach((order, index) => {
                const orderItem = document.createElement('div');
                orderItem.className = `order-item ${order.status === 'completed' ? 'completed' : ''}`;
                orderItem.style.animationDelay = `${index * 0.1}s`;
                
                let redeemCodeHtml = '';
                if (order.status === 'completed' && order.redeemCode) {
                    redeemCodeHtml = `
                        <div class="redeem-box">
                            <button class="copy-button" onclick="copyToClipboard('${order.redeemCode}', this)">
                                <i class="fas fa-copy"></i> Salin
                            </button>
                            <div class="redeem-label">
                                <i class="fas fa-key"></i>
                                Kode Redeem:
                            </div>
                            <div class="redeem-code">${order.redeemCode}</div>
                        </div>
                    `;
                }
                
                orderItem.innerHTML = `
                    <div class="order-header">
                        <div class="order-info">
                            <h4>Pesanan #${order.id}</h4>
                            <p class="order-date">${new Date(order.date).toLocaleString('id-ID')}</p>
                        </div>
                        <span class="badge ${order.status === 'pending' ? 'badge-pending' : 'badge-completed'}">
                            <i class="fas ${order.status === 'pending' ? 'fa-clock' : 'fa-check-circle'}"></i>
                            <span>${order.status === 'pending' ? 'Menunggu' : 'Selesai'}</span>
                        </span>
                    </div>
                    <div class="order-details">
                        <div class="order-detail-item">
                            <div class="order-detail-label">Produk</div>
                            <div>${order.productName}</div>
                        </div>
                        <div class="order-detail-item">
                            <div class="order-detail-label">Jumlah</div>
                            <div>${order.quantity}x</div>
                        </div>
                        <div class="order-detail-item">
                            <div class="order-detail-label">Total</div>
                            <div>Rp ${order.totalPrice.toLocaleString('id-ID')}</div>
                        </div>
                        <div class="order-detail-item">
                            <div class="order-detail-label">Metode</div>
                            <div>${order.paymentMethod}</div>
                        </div>
                    </div>
                    ${redeemCodeHtml}
                `;
                historyContainer.appendChild(orderItem);
            });
            
            console.log(' Order history loaded:', userOrders.length);
        }

        function loadOrders() {
            console.log(' Loading all orders...');
            const tbody = document.getElementById('ordersTableBody');
            tbody.innerHTML = '';

            if (orders.length === 0) {
                tbody.innerHTML = `
                    <tr>
                        <td colspan="6" style="text-align: center; padding: 3rem;">
                            <div class="empty-state">
                                <div class="empty-icon">
                                    <i class="fas fa-inbox"></i>
                                </div>
                                <h3 class="empty-title">Belum ada pesanan</h3>
                            </div>
                        </td>
                    </tr>
                `;
                return;
            }

            orders.forEach((order, index) => {
                const row = document.createElement('tr');
                row.style.animationDelay = `${index * 0.05}s`;
                row.innerHTML = `
                    <td>#${order.id}</td>
                    <td>${order.userId}</td>
                    <td>${order.productName} (${order.quantity}x)</td>
                    <td>Rp ${order.totalPrice.toLocaleString('id-ID')}</td>
                    <td>
                        <span class="badge ${order.status === 'pending' ? 'badge-pending' : 'badge-completed'}">
                            <i class="fas ${order.status === 'pending' ? 'fa-clock' : 'fa-check-circle'}"></i>
                            <span>${order.status === 'pending' ? 'Menunggu' : 'Selesai'}</span>
                        </span>
                    </td>
                    <td>
                        ${order.status === 'pending' ? `
                            <button class="btn btn-primary btn-sm" onclick="approveOrder(${order.id})">
                                <i class="fas fa-check"></i>
                                <span>Approve</span>
                            </button>
                        ` : `
                            <button class="btn btn-secondary btn-sm" onclick="viewOrderDetails(${order.id})">
                                <i class="fas fa-eye"></i>
                                <span>Lihat</span>
                            </button>
                        `}
                    </td>
                `;
                tbody.appendChild(row);
            });
            
            console.log(' Orders loaded:', orders.length);
        }

        function approveOrder(orderId) {
            const order = orders.find(o => o.id === orderId);
            if (!order) {
                showToast(' Pesanan tidak ditemukan', 'error');
                return;
            }

            console.log(' Approving order:', orderId);

            const modalBody = document.getElementById('orderModalBody');
            modalBody.innerHTML = `
                <div class="mb-6">
                    <h4 style="margin-bottom: 1.25rem;">Detail Pesanan #${order.id}</h4>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <p><strong>Pelanggan:</strong> ${order.userId}</p>
                            <p><strong>Produk:</strong> ${order.productName}</p>
                            <p><strong>Jumlah:</strong> ${order.quantity}</p>
                        </div>
                        <div>
                            <p><strong>Total:</strong> Rp ${order.totalPrice.toLocaleString('id-ID')}</p>
                            <p><strong>Metode:</strong> ${order.paymentMethod}</p>
                            <p><strong>Tanggal:</strong> ${new Date(order.date).toLocaleString('id-ID')}</p>
                        </div>
                    </div>
                </div>
                
                <div class="payment-proof">
                    <span class="proof-label">
                        <i class="fas fa-image"></i>
                        Bukti Pembayaran
                    </span>
                    <img src="${order.paymentProof}" alt="Bukti Pembayaran">
                </div>
                
                <div class="form-group mt-6">
                    <label class="form-label">
                        <i class="fas fa-key"></i>
                        Kode Redeem / Pesan Produk
                    </label>
                    <textarea class="form-control" id="redeemCode" rows="3" placeholder="Masukkan kode redeem atau detail produk"></textarea>
                </div>
                
                <button class="btn btn-primary btn-block" onclick="confirmApprove(${orderId})">
                    <i class="fas fa-paper-plane"></i>
                    <span>Kirim ke Pelanggan</span>
                </button>
            `;

            document.getElementById('orderModal').classList.add('active');
        }

        function confirmApprove(orderId) {
            const redeemCode = document.getElementById('redeemCode').value.trim();
            if (!redeemCode) {
                showToast(' Masukkan kode redeem atau detail produk!', 'error');
                shakeElement(document.getElementById('redeemCode'));
                return;
            }

            const order = orders.find(o => o.id === orderId);
            if (order) {
                order.status = 'completed';
                order.redeemCode = redeemCode;
                order.completedDate = new Date().toISOString();
                saveData();
                
                closeModal('orderModal');
                showToast(' Pesanan berhasil dikonfirmasi dan kode telah dikirim!', 'success');
                loadOrders();
            }
        }

        function viewOrderDetails(orderId) {
            const order = orders.find(o => o.id === orderId);
            if (!order) {
                showToast(' Pesanan tidak ditemukan', 'error');
                return;
            }

            const modalBody = document.getElementById('orderModalBody');
            modalBody.innerHTML = `
                <div class="mb-6">
                    <h4 style="margin-bottom: 1.25rem;">Detail Pesanan #${order.id}</h4>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <p><strong>Pelanggan:</strong> ${order.userId}</p>
                            <p><strong>Produk:</strong> ${order.productName}</p>
                            <p><strong>Jumlah:</strong> ${order.quantity}</p>
                        </div>
                        <div>
                            <p><strong>Total:</strong> Rp ${order.totalPrice.toLocaleString('id-ID')}</p>
                            <p><strong>Metode:</strong> ${order.paymentMethod}</p>
                            <p><strong>Status:</strong> <span class="badge badge-completed">Selesai</span></p>
                        </div>
                    </div>
                    ${order.redeemCode ? `
                        <div class="redeem-box mt-4">
                            <div class="redeem-label">
                                <i class="fas fa-key"></i>
                                Kode Redeem:
                            </div>
                            <div class="redeem-code">${order.redeemCode}</div>
                        </div>
                    ` : ''}
                </div>
                
                <div class="payment-proof">
                    <span class="proof-label">
                        <i class="fas fa-image"></i>
                        Bukti Pembayaran
                    </span>
                    <img src="${order.paymentProof}" alt="Bukti Pembayaran">
                </div>
                
                <button class="btn btn-secondary btn-block" style="margin-top: 1.25rem;" onclick="closeModal('orderModal')">
                    <i class="fas fa-times"></i>
                    <span>Tutup</span>
                </button>
            `;

            document.getElementById('orderModal').classList.add('active');
        }

        console.log(' Order management functions loaded');
    </script>
    <script>
        // ===== USER MANAGEMENT =====
        function loadUserList() {
            console.log(' Loading user list...');
            const listContainer = document.getElementById('userList');
            listContainer.innerHTML = '';
            
            if (users.length === 0) {
                listContainer.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-icon">
                            <i class="fas fa-users"></i>
                        </div>
                        <h3 class="empty-title">Belum ada user</h3>
                        <p class="empty-description">Belum ada user yang mendaftar</p>
                    </div>
                `;
                return;
            }
            
            users.forEach((user, index) => {
                const userOrders = orders.filter(order => order.userId === user.username);
                const totalSpent = userOrders.reduce((sum, order) => sum + order.totalPrice, 0);
                
                const item = document.createElement('div');
                item.className = 'admin-item';
                item.style.animationDelay = `${index * 0.1}s`;
                item.innerHTML = `
                    <div class="admin-item-header">
                        <div class="user-avatar" style="width: 60px; height: 60px; font-size: 1.5rem;">
                            <i class="fas fa-user"></i>
                        </div>
                        <div class="admin-item-info">
                            <h4 class="admin-item-title">${user.username}</h4>
                            <p class="admin-item-meta">${user.email}</p>
                            <p class="admin-item-meta">Bergabung: ${new Date(user.registeredAt).toLocaleDateString('id-ID')}</p>
                            <div class="flex gap-4 mt-2">
                                <span class="badge badge-completed">
                                    <i class="fas fa-shopping-cart"></i>
                                    <span>${userOrders.length} Pesanan</span>
                                </span>
                                <span class="badge badge-completed">
                                    <i class="fas fa-money-bill"></i>
                                    <span>Rp ${totalSpent.toLocaleString('id-ID')}</span>
                                </span>
                            </div>
                        </div>
                    </div>
                    <div class="admin-item-actions">
                        <button class="btn btn-danger btn-sm" onclick="deleteUser('${user.username}')">
                            <i class="fas fa-trash"></i>
                            <span>Hapus</span>
                        </button>
                    </div>
                `;
                listContainer.appendChild(item);
            });
            
            console.log(' User list loaded:', users.length);
        }

        function deleteUser(username) {
            if (!username) {
                showToast(' Username tidak valid', 'error');
                return;
            }

            const user = users.find(u => u.username === username);
            if (!user) {
                showToast(' User tidak ditemukan', 'error');
                return;
            }

            console.log(' Deleting user:', username);

            const userOrders = orders.filter(order => order.userId === username);
            if (userOrders.length > 0) {
                if (!confirm(`User "${username}" memiliki ${userOrders.length} pesanan. Semua data akan dihapus. Lanjutkan?`)) {
                    return;
                }
            }

            if (confirm(`Apakah Anda yakin ingin menghapus user "${username}"?`)) {
                users = users.filter(u => u.username !== username);
                orders = orders.filter(o => o.userId !== username);
                saveData();
                loadUserList();
                showToast(' User berhasil dihapus!', 'success');
            }
        }

        // ===== PURCHASE MODAL =====
        function openPurchaseModal(productId) {
            selectedProduct = products.find(p => p.id === productId);
            if (!selectedProduct) {
                showToast(' Produk tidak ditemukan', 'error');
                return;
            }

            if (selectedProduct.stock === 0) {
                showToast(' Produk sedang habis', 'error');
                return;
            }

            if (paymentMethods.length === 0) {
                showToast(' Tidak ada metode pembayaran tersedia', 'error');
                return;
            }

            console.log(' Opening purchase modal for:', selectedProduct.name);

            const modalBody = document.getElementById('purchaseModalBody');
            modalBody.innerHTML = `
                <div class="mb-6">
                    <h4>${selectedProduct.name}</h4>
                    <p style="color: var(--text-secondary); margin-bottom: 1rem;">${selectedProduct.description}</p>
                    <p style="font-size: 1.625rem; color: var(--primary); font-weight: 700;">Rp ${selectedProduct.price.toLocaleString('id-ID')}</p>
                    <p style="color: var(--text-secondary); font-size: 0.875rem;">Stok tersedia: <span style="color: var(--success); font-weight: 600;">${selectedProduct.stock}</span></p>
                </div>
                
                <div class="form-group">
                    <label class="form-label">
                        <i class="fas fa-cubes"></i>
                        Jumlah
                    </label>
                    <div class="quantity-selector">
                        <button type="button" class="quantity-btn" onclick="updateQuantity(-1)">
                            <i class="fas fa-minus"></i>
                        </button>
                        <input type="number" id="quantity" class="quantity-input" value="1" min="1" max="${selectedProduct.stock}">
                        <button type="button" class="quantity-btn" onclick="updateQuantity(1)">
                            <i class="fas fa-plus"></i>
                        </button>
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label">
                        <i class="fas fa-credit-card"></i>
                        Metode Pembayaran
                    </label>
                    <div class="payment-grid">
                        ${paymentMethods.map(method => `
                            <div class="payment-method" onclick="selectPayment(${method.id})">
                                <img src="${method.image}" alt="${method.name}" class="payment-image">
                                <div class="payment-name">${method.name}</div>
                                <div class="payment-number">${method.number}</div>
                            </div>
                        `).join('')}
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label">
                        <i class="fas fa-camera"></i>
                        Upload Bukti Pembayaran
                    </label>
                    <div class="file-upload">
                        <input type="file" id="paymentProof" accept="image/*" onchange="previewImage(event, 'proofPreview')">
                        <label for="paymentProof" class="file-upload-label">
                            <div class="file-upload-icon">
                                <i class="fas fa-camera"></i>
                            </div>
                            <p>Upload Bukti Pembayaran</p>
                            <p class="text-small">PNG, JPG max 10MB</p>
                        </label>
                    </div>
                    <img id="proofPreview" class="image-preview" alt="Bukti Pembayaran">
                </div>
                </div>

                <button class="btn btn-primary btn-block" onclick="submitOrder()">
                    <i class="fas fa-check"></i>
                    <span>Submit Pesanan</span>
                </button>
            `;

            document.getElementById('purchaseModal').classList.add('active');
        }

        function updateQuantity(change) {
            const input = document.getElementById('quantity');
            if (!input) return;
            
            let value = parseInt(input.value) + change;
            if (value < 1) value = 1;
            if (value > selectedProduct.stock) {
                showToast(` Maksimal stok: ${selectedProduct.stock}`, 'error');
                value = selectedProduct.stock;
                shakeElement(input);
            }
            input.value = value;
        }

        function selectPayment(paymentId) {
            selectedPaymentId = paymentId;
            document.querySelectorAll('.payment-method').forEach(el => {
                el.classList.remove('selected');
            });
            event.currentTarget.classList.add('selected');
        }

        function submitOrder() {
            const quantityInput = document.getElementById('quantity');
            const paymentProofInput = document.getElementById('paymentProof');

            if (!quantityInput || !paymentProofInput) {
                showToast(' Form tidak lengkap', 'error');
                return;
            }

            const quantity = parseInt(quantityInput.value);
            const paymentProof = paymentProofInput.files[0];

            if (!selectedPaymentId) {
                showToast(' Pilih metode pembayaran!', 'error');
                return;
            }

            if (!paymentProof) {
                showToast(' Upload bukti pembayaran!', 'error');
                return;
            }

            // Double check stock
            if (quantity > selectedProduct.stock) {
                showToast(' Stok tidak mencukup!', 'error');
                return;
            }

            console.log(' Submitting order:', { quantity, productId: selectedProduct.id });

            const reader = new FileReader();
            reader.onload = function(e) {
                const order = {
                    id: Date.now(),
                    userId: currentUser.username,
                    productId: selectedProduct.id,
                    productName: selectedProduct.name,
                    quantity: quantity,
                    totalPrice: selectedProduct.price * quantity,
                    paymentMethod: paymentMethods.find(p => p.id === selectedPaymentId).name,
                    paymentProof: e.target.result,
                    status: 'pending',
                    date: new Date().toISOString()
                };

                orders.push(order);
                saveData();

                // Update stock
                selectedProduct.stock -= quantity;
                saveData();

                closeModal('purchaseModal');
                showToast(' Pesanan berhasil dikirim! Menunggu konfirmasi admin.', 'success');
                loadProducts();
            };
            reader.readAsDataURL(paymentProof);
        }

        console.log(' Purchase functions loaded');
    </script>

    <script>
        // ===== UTILITY FUNCTIONS =====
        function previewImage(event, previewId) {
            const file = event.target.files[0];
            if (file) {
                // Validate file size (max 10MB)
                if (file.size > 10 * 1024 * 1024) {
                    showToast(' Ukuran file maksimal 10MB', 'error');
                    return;
                }

                // Validate file type
                if (!file.type.startsWith('image/')) {
                    showToast(' Hanya file gambar yang diperbolehkan', 'error');
                    return;
                }

                const reader = new FileReader();
                reader.onload = function(e) {
                    const preview = document.getElementById(previewId);
                    if (preview) {
                        preview.src = e.target.result;
                        preview.style.display = 'block';
                        preview.classList.add('fade-in');
                    }
                };
                reader.readAsDataURL(file);
            }
        }

        function copyToClipboard(text, button) {
            if (!navigator.clipboard) {
                // Fallback for older browsers
                const textArea = document.createElement('textarea');
                textArea.value = text;
                textArea.style.position = 'fixed';
                textArea.style.left = '-9999px';
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
                
                const originalText = button.innerHTML;
                button.innerHTML = '<i class="fas fa-check"></i> Tersalin!';
                button.classList.add('success');
                
                setTimeout(() => {
                    button.innerHTML = originalText;
                    button.classList.remove('success');
                }, 2000);
                
                showToast(' Kode berhasil disalin!', 'success');
                return;
            }

            navigator.clipboard.writeText(text).then(() => {
                const originalText = button.innerHTML;
                button.innerHTML = '<i class="fas fa-check"></i> Tersalin!';
                button.classList.add('success');
                
                setTimeout(() => {
                    button.innerHTML = originalText;
                    button.classList.remove('success');
                }, 2000);
                
                showToast(' Kode berhasil disalin!', 'success');
            }).catch(err => {
                console.error(' Failed to copy text: ', err);
                showToast(' Gagal menyalin kode', 'error');
            });
        }

        function closeModal(modalId) {
            const modal = document.getElementById(modalId);
            if (modal) {
                modal.classList.remove('active');
            }
        }

        function showToast(message, type = 'success', duration = 3000) {
            const toast = document.getElementById('toast');
            const toastMessage = document.getElementById('toastMessage');
            const toastIcon = toast.querySelector('.toast-icon i');
            
            if (!toast || !toastMessage || !toastIcon) {
                console.error(' Toast elements not found');
                return;
            }
            
            // Remove existing classes
            toast.className = 'toast';
            
            // Add type class
            if (type === 'error') {
                toast.classList.add('error');
                toastIcon.className = 'fas fa-exclamation-circle';
            } else if (type === 'success') {
                toast.classList.add('success');
                toastIcon.className = 'fas fa-check-circle';
            } else if (type === 'warning') {
                toast.classList.add('warning');
                toastIcon.className = 'fas fa-exclamation-triangle';
            } else if (type === 'info') {
                toast.classList.add('info');
                toastIcon.className = 'fas fa-info-circle';
            }
            
            toastMessage.textContent = message;
            toast.classList.add('show');
            
            // Auto hide after duration
            setTimeout(() => {
                toast.classList.remove('show');
            }, duration);
        }

        // ===== DEBUG FUNCTIONS =====
        function debugLog(message, data = null) {
            if (window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1') {
                console.log(' DEBUG:', message, data);
            }
        }

        // ===== VALIDATION FUNCTIONS =====
        function validateForm(formId) {
            const form = document.getElementById(formId);
            if (!form) return false;

            const inputs = form.querySelectorAll('input[required], textarea[required]');
            let isValid = true;

            inputs.forEach(input => {
                if (!input.value.trim()) {
                    input.classList.add('error');
                    isValid = false;
                    shakeElement(input);
                } else {
                    input.classList.remove('error');
                }
            });

            return isValid;
        }

        function clearValidation(formId) {
            const form = document.getElementById(formId);
            if (form) {
                form.querySelectorAll('.error').forEach(input => {
                    input.classList.remove('error');
                });
            }
        }

        // ===== ANIMATION HELPERS =====
        function animateElement(element, animation) {
            if (element) {
                element.classList.add(animation);
                setTimeout(() => {
                    element.classList.remove(animation);
                }, 1000);
            }
        }

        function debounce(func, wait) {
            let timeout;
            return function executedFunction(...args) {
                const later = () => {
                    clearTimeout(timeout);
                    timeout = setTimeout(() => {
                        func(...args);
                    clearTimeout(timeout);
                }, wait);
                };
                clearTimeout(timeout);
                timeout = later();
            };
        }

        // ===== STORAGE HELPERS =====
        function clearAllData() {
            if (confirm(' Apakah Anda yakin ingin menghapus SEMUA data? Ini tidak dapat dibatalkan!')) {
                localStorage.clear();
                location.reload();
            }
        }

        function exportData() {
            const data = {
                products,
                paymentMethods,
                orders,
                users,
                exportDate: new Date().toISOString()
            };
            
            const dataStr = JSON.stringify(data, null, 2);
            const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);
            
            const exportFileDefaultName = 'kaii-store-backup-' + new Date().toISOString().split('T')[0] + '.json';
            
            const linkElement = document.createElement('a');
            linkElement.setAttribute('href', dataUri);
            linkElement.setAttribute('download', exportFileDefaultName);
            linkElement.click();
            
            showToast(' Data berhasil diekspor!', 'success');
        }

        // ===== PERFORMANCE HELPERS =====
        function lazyLoadImages() {
            const images = document.querySelectorAll('img[data-src]');
            const imageObserver = new IntersectionObserver((entries, observer) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        const img = entry.target;
                        img.src = img.dataset.src;
                        img.removeAttribute('data-src');
                        observer.unobserve(img);
                    }
                });
            });

            images.forEach(img => imageObserver.observe(img));
        }

        // Initialize lazy loading
        document.addEventListener('DOMContentLoaded', lazyLoadImages);

        console.log(' Utility functions loaded');
    </script>
    <script>
        // ===== EVENT LISTENERS =====
        function setupEventListeners() {
            // Close modals when clicking outside
            document.addEventListener('click', function(event) {
                if (event.target.classList.contains('modal')) {
                    event.target.classList.remove('active');
                }
            });

            // Form submissions
            document.getElementById('authForm').addEventListener('submit', handleAuth);
            
            // Prevent form resubmission on page refresh
            if (window.history.replaceState) {
                window.history.replaceState(null, null, window.location.href);
            }

            // Keyboard shortcuts
            document.addEventListener('keydown', function(event) {
                // ESC to close modals
                if (event.key === 'Escape') {
                    document.querySelectorAll('.modal.active').forEach(modal => {
                        modal.classList.remove('active');
                    });
                }
                
                // Ctrl+L for quick login (if not logged in)
                if (event.ctrlKey && event.key === 'l' && !currentUser) {
                    showLogin();
                }
                
                // Ctrl+A for admin panel (if admin)
                if (event.ctrlKey && event.key === 'a' && currentUser && currentUser.role === 'admin') {
                    showAdminPanel();
                }
            });

            // Handle browser back/forward
            window.addEventListener('popstate', function(event) {
                if (event.state && event.state.page) {
                    // Handle navigation based on state
                    switch(event.state.page) {
                        case 'login':
                            showLogin();
                            break;
                        case 'register':
                            showRegister();
                            break;
                        case 'dashboard':
                            if (currentUser) {
                                if (currentUser.role === 'admin') {
                                    showAdminPanel();
                                } else {
                                    showUserDashboard();
                                }
                            }
                            break;
                    }
                }
            });

            // Online/Offline status
            window.addEventListener('online', () => {
                showToast(' Koneksi tersambung', 'success', 2000);
            });

            window.addEventListener('offline', () => {
                showToast(' Koneksi terputus', 'warning', 3000);
            });

            // Visibility change (user switched tabs)
            document.addEventListener('visibilitychange', () => {
                if (document.hidden) {
                    console.log(' Tab tidak aktif');
                } else {
                    console.log(' Tab aktif');
                }
            });

            // Before unload (warn user if there are unsaved changes)
            window.addEventListener('beforeunload', function(event) {
                if (currentUser && document.querySelector('.form-control:valid')) {
                    event.preventDefault();
                    event.returnValue = 'Ada perubahan yang belum disimpan!';
                }
            });

            console.log(' Event listeners setup complete');
        }

        // ===== INITIALIZATION ENHANCED =====
        function initializeApp() {
            try {
                // Show loading state
                showLoadingState();
                
                // Load data
                loadData();
                
                // Check authentication
                checkAuth();
                
                // Setup event listeners
                setupEventListeners();
                
                // Initialize tooltips
                initializeTooltips();
                
                // Initialize form validation
                initializeFormValidation();
                
                // Check if it's first visit
                checkFirstVisit();
                
                // Initialize service worker for PWA
                initializeServiceWorker();
                
                // Hide loading state
                hideLoadingState();
                
                console.log(' App initialized successfully');
                showToast(' Selamat datang di KAII STORE!', 'success', 2000);
                
            } catch (error) {
                console.error(' Error initializing app:', error);
                showToast('Error initializing app', 'error');
                hideLoadingState();
            }
        }

        function showLoadingState() {
            const loader = document.createElement('div');
            loader.id = 'loader';
            loader.innerHTML = `
                <div style="
                    position: fixed;
                    top: 0;
                    left: 0;
                    width: 100%;
                    height: 100%;
                    background: rgba(0, 0, 0, 0.8);
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    z-index: 9999;
                ">
                    <div class="loading"></div>
                    <p style="color: white; margin-top: 1rem;">Memuat...</p>
                </div>
            `;
            document.body.appendChild(loader);
        }

        function hideLoadingState() {
            const loader = document.getElementById('loader');
            if (loader) {
                loader.remove();
            }
        }

        function initializeTooltips() {
            // Add tooltips to elements with title attribute
            document.querySelectorAll('[title]').forEach(element => {
                element.style.position = 'relative';
                element.style.cursor = 'help';
            });
        }

        function initializeFormValidation() {
            // Add real-time validation
            document.querySelectorAll('.form-control').forEach(input => {
                input.addEventListener('input', function() {
                    if (this.checkValidity()) {
                        this.classList.remove('error');
                    } else {
                        this.classList.add('error');
                    }
                });
            });
        }

        function checkFirstVisit() {
            const hasVisited = localStorage.getItem('kaii_store_visited');
            if (!hasVisited) {
                localStorage.setItem('kaii_store_visited', 'true');
                // Show welcome modal or tutorial
                setTimeout(() => {
                    showToast(' Selamat datang di KAII STORE! Admin: admin/admin123', 'info', 5000);
                }, 1000);
            }
        }

        function initializeServiceWorker() {
            if ('serviceWorker' in navigator) {
                navigator.serviceWorker.register('/sw.js').then(registration => {
                    console.log(' Service Worker registered');
                }).catch(error => {
                    console.log(' Service Worker registration failed:', error);
                });
            }
        }

        // ===== ERROR HANDLING =====
        function handleError(error, context = 'Unknown') {
            console.error(` [${context}] ${error.message || error}`);
            showToast(`Terjadi kesalahan: ${error.message || 'Unknown error'}`, 'error');
            
            // Log error to service (if available)
            if (window.errorReporting) {
                window.errorReporting && window.errorReporting(error);
            }
        }

        // ===== PERFORMANCE MONITORING =====
        function measurePerformance() {
            if ('performance' in window) {
                const perfData = performance.getEntriesByType('navigation')[0];
                console.log(' Performance Metrics:', {
                    domContentLoaded: perfData.domContentLoaded,
                    loadEventEnd: perfData.loadEventEnd,
                    firstPaint: perfData.firstPaint,
                    loadTime: perfData.loadEventEnd - perfData.navigationStart
                });
            }
        }

        // Measure performance after page load
        setTimeout(measurePerformance, 2000);

        // ===== AUTO-SAVE =====
        function setupAutoSave() {
            let saveTimeout;
            
            function scheduleSave() {
                clearTimeout(saveTimeout);
                saveTimeout = setTimeout(() => {
                    if (currentUser) {
                        saveData();
                        console.log(' Auto-saved data');
                    }
                }, 30000); // Auto-save every 30 seconds
            }
            
            // Schedule first save
            scheduleSave();
            
            // Save on data changes
            const originalSaveData = saveData;
            saveData = function() {
                originalSaveData();
                scheduleSave();
            };
        }

        // Initialize auto-save
        setupAutoSave();

        console.log(' Enhanced event listeners loaded');
    </script>
    <script>
        // ===== MAIN APP ENTRY POINT =====
        document.addEventListener('DOMContentLoaded', function() {
            console.log(' KAII STORE - Starting initialization...');
            
            // Initialize app
            initializeApp();
            
            // Add global error handler
            window.addEventListener('error', function(event) {
                handleError(event.error, 'JavaScript Error');
            });
            
            // Add global success handler for debugging
            window.showToast = function(message, type, duration) {
                // Enhanced toast function with more options
                const toast = document.getElementById('toast');
                const toastMessage = document.getElementById('toastMessage');
                const toastIcon = toast.querySelector('.toast-icon i');
                
                if (!toast || !toastMessage || !toastIcon) {
                    console.error(' Toast elements not found');
                    return;
                }
                
                // Remove existing classes
                toast.className = 'toast';
                
                // Add type class
                if (type === 'error') {
                    toast.classList.add('error');
                    toastIcon.className = 'fas fa-exclamation-circle';
                } else if (type === 'success') {
                    toast.classList.add('success');
                    toastIcon.className = 'fas fa-check-circle';
                } else if (type === 'warning') {
                    toast.classList.add('warning');
                    toastIcon.className = 'fas fa-exclamation-triangle';
                } else if (type === 'info') {
                    toast.classList.add('info');
                    toastIcon.className = 'fas fa-info-circle';
                }
                
                toastMessage.textContent = message;
                toast.classList.add('show');
                
                // Auto hide after duration
                setTimeout(() => {
                    toast.classList.remove('show');
                }, duration || 3000);
            };
            
            // Override the original showToast function
            window.showToast = showToast;
        });

            // Add global error handler
            window.handleError = handleError;
            
            // Add global debug function
            window.debugLog = debugLog;
            
            // Add global clearValidation function
            window.clearValidation = clearValidation;
            
            // Add global animateElement function
            window.animateElement = animateElement;
            
            // Add global shakeElement function
            window.shakeElement = shakeElement;
            
            // Add global clearAllData function
            window.clearAllData = clearAllData;
            
            // Add global exportData function
            window.exportData = exportData;
            
            // Add global measurePerformance function
            window.measurePerformance = measurePerformance;
            
            // Initialize PWA features
            if ('serviceWorker' in navigator) {
                navigator.serviceWorker.register('/sw.js').catch(error => {
                    console.log('Service Worker registration failed:', error);
                });
            }
            
            // Add network status listener
            window.addEventListener('online', () => {
                document.body.classList.remove('offline');
                showToast(' Koneksi tersambung', 'success', 2000);
            });
            
            window.addEventListener('offline', () => {
                document.body.classList.add('offline');
                showToast(' Koneksi terputus', 'warning', 3000);
            });
            
            console.log(' Enhanced global functions loaded');
        });

        // ===== FINAL INITIALIZATION =====
        function finalizeInitialization() {
            // Remove loading state if still visible
            hideLoadingState();
            
            // Add smooth scroll behavior
            document.documentElement.style.scrollBehavior = 'smooth';
            
            // Add page visibility tracking
            let pageVisibility = 'visible';
            document.addEventListener('visibilitychange', () => {
                pageVisibility = document.hidden ? 'hidden' : 'visible';
                if (pageVisibility === 'visible') {
                    console.log(' Page became visible');
                } else {
                    console.log(' Page hidden');
                }
            });
            
            // Add resize handler with debouncing
            let resizeTimeout;
            window.addEventListener('resize', () => {
                clearTimeout(resizeTimeout);
                resizeTimeout = setTimeout(() => {
                    console.log(' Window resized');
                    // Handle responsive adjustments
                    handleResponsiveChanges();
                }, 250);
            });
            
            // Add focus management
            let focusedElement = null;
            document.addEventListener('focusin', (e) => {
                focusedElement = e.target;
                focusedElement.classList.add('focused');
            });
            
            document.addEventListener('focusout', (e) => {
                if (focusedElement) {
                    focusedElement.classList.remove('focused');
                }
            });
            
            console.log(' Final initialization complete');
        }

        // Handle responsive changes
        function handleResponsiveChanges() {
            const isMobile = window.innerWidth <= 768;
            const isTablet = window.innerWidth <= 1024;
            
            // Adjust grid layouts
            const productGrid = document.getElementById('productsGrid');
            if (productGrid) {
                if (isMobile) {
                    productGrid.style.gridTemplateColumns = '1fr';
                } else if (isTablet) {
                    productGrid.style.gridTemplateColumns = 'repeat(2, 1fr)';
                } else {
                    productGrid.style.gridTemplateColumns = 'repeat(auto-fill, minmax(300px, 1fr))';
                }
            }
            
            // Adjust modal sizes
            const modals = document.querySelectorAll('.modal-content');
            modals.forEach(modal => {
                if (isMobile) {
                    modal.style.padding = '1.5rem';
                    modal.style.margin = '1rem';
                } else if (isTablet) {
                    modal.style.padding = '2rem';
                    modal.style.margin = '2rem';
                }
            });
        }

        // Finalize initialization
        setTimeout(() => {
            finalizeInitialization();
        }, 100);

        // Console welcome message
        console.log(`
            
            
            
            
            
            
            ?
</body>
</html>
